<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024a"><title>FFT-Based 2-D Convolution Example</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { border-left: 0px none rgb(33, 33, 33); border-right: 0px none rgb(33, 33, 33); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px; line-height: 15.6px; min-height: 16px; white-space: pre; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S3 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S4 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.eoOutputWrapper { width: calc(90vw - 10px) !important; }
.S5 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 0px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S6 { color: rgb(33, 33, 33); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px; overflow-x: hidden; line-height: 17.234px;  }
.S7 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 0px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S9 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S10 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S11 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span>FFT-Based 2-D Convolution Example</span></h1><div  class = 'S1'><span>This example shows how to determine zero-padding sizes for efficient FFT-based computation of 2-D convolution.</span></div><div  class = 'S1'><span>When using FFTs to compute a full convolution, it is necessary to zero-pad the FFTs. If </span><span style=' font-family: monospace;'>A</span><span> is </span><span texencoding="M \times N" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="46.5" height="18" /></span><span> and </span><span style=' font-family: monospace;'>B</span><span> is </span><span texencoding="P \times Q" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="39.5" height="18" /></span><span>, then the full convolution of the two matrices is </span><span texencoding="K \times L" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="40.5" height="18" /></span><span>, where </span><span texencoding="K = M+P-1" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="98.5" height="18" /></span><span> and </span><span texencoding="L = N+Q-1" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="96" height="18" /></span><span>. The functions </span><span style=' font-family: monospace;'>fft2</span><span> and </span><span style=' font-family: monospace;'>ifft2</span><span> can be use to compute the full convolution as follows:</span></div><div class = 'preformatted-matlab' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S2'><span style="white-space: pre"><span >[M,N] = size(A);</span></span></div><div  class = 'S2'><span style="white-space: pre"><span >[P,Q] = size(B);</span></span></div><div  class = 'S2'><span style="white-space: pre"><span >K = M + P - 1;</span></span></div><div  class = 'S2'><span style="white-space: pre"><span >L = N + Q - 1;</span></span></div><div  class = 'S2'>&nbsp;</div><div  class = 'S2'><span style="white-space: pre"><span >AA = fft2(A,K,L);  </span><span style="color: #008013;">% Computes FFT2 zero-padded to KxL</span></span></div><div  class = 'S2'><span style="white-space: pre"><span >BB = fft2(B,K,L);</span></span></div><div  class = 'S2'><span style="white-space: pre"><span >C = ifft2(AA .* BB);</span></span></div></div><div  class = 'S1'><span>Depending on the values of </span><span style="font-family: STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">K</span><span> and </span><span style="font-family: STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">L</span><span>, the computation can often be sped up by using somewhat larger transform lengths, and that is where </span><span style=' font-family: monospace;'>fftTransformLength</span><span> comes in. The modified code looks like this:</span></div><div class = 'preformatted-matlab' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S2'><span style="white-space: pre"><span >[M,N] = size(A);</span></span></div><div  class = 'S2'><span style="white-space: pre"><span >[P,Q] = size(B);</span></span></div><div  class = 'S2'><span style="white-space: pre"><span >K = M + P - 1;</span></span></div><div  class = 'S2'><span style="white-space: pre"><span >L = N + Q - 1;</span></span></div><div  class = 'S2'>&nbsp;</div><div  class = 'S2'><span style="white-space: pre"><span >K2 = fftTransformLength(K);</span></span></div><div  class = 'S2'><span style="white-space: pre"><span >L2 = fftTransformLength(L);</span></span></div><div  class = 'S2'>&nbsp;</div><div  class = 'S2'><span style="white-space: pre"><span >AA = fft2(A,K2,L2);  </span><span style="color: #008013;">% Computes FFT2 zero-padded to K2xL2</span></span></div><div  class = 'S2'><span style="white-space: pre"><span >BB = fft2(B,K2,L2);</span></span></div><div  class = 'S2'><span style="white-space: pre"><span >CC = ifft2(AA .* BB);</span></span></div><div  class = 'S2'><span style="white-space: pre"><span >C = CC(1:K,1:L);     </span><span style="color: #008013;">% The convolution result is still only KxL</span></span></div></div><div  class = 'S1'><span>Here is an example comparing the computation speed for the two methods described above. The function </span><span style=' font-family: monospace;'>conv2_fft_v1</span><span>, located at the bottom of this script, is the first method. The function </span><span style=' font-family: monospace;'>conv2_fft_v2</span><span> is the second method, using </span><span style=' font-family: monospace;'>fftTransformLength</span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >A = rand(1170,1170);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >B = rand(101,101);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >f = @() conv2_fft_v1(A,B);</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S5'><span style="white-space: pre"><span >t_f = timeit(f)</span></span></div><div  class = 'S6'><div class='variableElement' style='font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px; '>t_f = 0.0335</div></div></div><div class="inlineWrapper"><div  class = 'S7'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >g = @() conv2_fft_v2(A,B);</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S5'><span style="white-space: pre"><span >t_g = timeit(g)</span></span></div><div  class = 'S6'><div class='variableElement' style='font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px; '>t_g = 0.0218</div></div></div><div class="inlineWrapper outputs"><div  class = 'S8'><span style="white-space: pre"><span >speedup = t_f / t_g</span></span></div><div  class = 'S6'><div class='variableElement' style='font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px; '>speedup = 1.5383</div></div></div></div><div  class = 'S9'><span>Even with the additional steps required (to compute the transform length and to extract the </span><span texencoding="K \times L" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="40.5" height="18" /></span><span> submatrix at the end), the method based on </span><span style=' font-family: monospace;'>fftTransformLength</span><span> executes approximately 50% faster.</span></div><h2  class = 'S10'><span>Convolution implementations</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >C = conv2_fft_v1(A,B)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    [M,N] = size(A);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    [P,Q] = size(B);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    K = M + P - 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    L = N + Q - 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    AA = fft2(A,K,L);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    BB = fft2(B,K,L);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    C = ifft2(AA .* BB);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #0e00ff;">function </span><span >C = conv2_fft_v2(A,B)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    [M,N] = size(A);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    [P,Q] = size(B);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    K = M + P - 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    L = N + Q - 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    K2 = fftTransformLength(K);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    L2 = fftTransformLength(L);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    AA = fft2(A,K2,L2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    BB = fft2(B,K2,L2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    CC = ifft2(AA .* BB);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    C = CC(1:K,1:L);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: #0e00ff;">end</span></span></div></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% FFT-Based 2-D Convolution Example
% This example shows how to determine zero-padding sizes for efficient FFT-based 
% computation of 2-D convolution.
% 
% When using FFTs to compute a full convolution, it is necessary to zero-pad 
% the FFTs. If |A| is $M \times N$ and |B| is $P \times Q$, then the full convolution 
% of the two matrices is $K \times L$, where $K = M+P-1$ and $L = N+Q-1$. The 
% functions |fft2| and |ifft2| can be use to compute the full convolution as follows:
%%
% 
%   [M,N] = size(A);
%   [P,Q] = size(B);
%   K = M + P - 1;
%   L = N + Q - 1;
%   
%   AA = fft2(A,K,L);  % Computes FFT2 zero-padded to KxL
%   BB = fft2(B,K,L);
%   C = ifft2(AA .* BB);
%
%% 
% Depending on the values of $K$ and $L$, the computation can often be sped 
% up by using somewhat larger transform lengths, and that is where |fftTransformLength| 
% comes in. The modified code looks like this:
%%
% 
%   [M,N] = size(A);
%   [P,Q] = size(B);
%   K = M + P - 1;
%   L = N + Q - 1;
%   
%   K2 = fftTransformLength(K);
%   L2 = fftTransformLength(L);
%   
%   AA = fft2(A,K2,L2);  % Computes FFT2 zero-padded to K2xL2
%   BB = fft2(B,K2,L2);
%   CC = ifft2(AA .* BB);
%   C = CC(1:K,1:L);     % The convolution result is still only KxL
%
%% 
% Here is an example comparing the computation speed for the two methods described 
% above. The function |conv2_fft_v1|, located at the bottom of this script, is 
% the first method. The function |conv2_fft_v2| is the second method, using |fftTransformLength|.

A = rand(1170,1170);
B = rand(101,101);

f = @() conv2_fft_v1(A,B);
t_f = timeit(f)

g = @() conv2_fft_v2(A,B);
t_g = timeit(g)
speedup = t_f / t_g
%% 
% Even with the additional steps required (to compute the transform length and 
% to extract the $K \times L$ submatrix at the end), the method based on |fftTransformLength| 
% executes approximately 50% faster.
%% Convolution implementations

function C = conv2_fft_v1(A,B)
    [M,N] = size(A);
    [P,Q] = size(B);
    K = M + P - 1;
    L = N + Q - 1;

    AA = fft2(A,K,L);
    BB = fft2(B,K,L);
    C = ifft2(AA .* BB);
end

function C = conv2_fft_v2(A,B)
    [M,N] = size(A);
    [P,Q] = size(B);
    K = M + P - 1;
    L = N + Q - 1;

    K2 = fftTransformLength(K);
    L2 = fftTransformLength(L);

    AA = fft2(A,K2,L2);
    BB = fft2(B,K2,L2);
    CC = ifft2(AA .* BB);
    C = CC(1:K,1:L);
end
##### SOURCE END #####
-->
</div></body></html>